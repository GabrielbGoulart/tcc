## SCRIPT PARA CRIAR VALORES ARTIFICIAIS
import random
from influxdb_client import InfluxDBClient
import datetime

from influxdb_client import InfluxDBClient, Point, WritePrecision
from influxdb_client.client.write_api import SYNCHRONOUS
token = "VvspivljE2nHPMArtuXqOusd86G08q5iEY_c8MTPxUvTR6ttYAurpe2yDkz8T5Y597sLNzGndy_yewWQEVCrlA=="
org = "ufc"
bucket = "prices"
client = InfluxDBClient(url="http://localhost:8086", token=token, org=org)
write_api = client.write_api(write_options=SYNCHRONOUS)

start_prices = [13.31,60.71,342.84,16.47,15.4,1.49,5.48,15.8,16.2,17.03,19.18,7.11,5.51,18.49,5.14,730.78,2855.72,16.85,18.0,54.24,2.46,112.69,1.01,35.97,26.85,133.58,18.93,24.93,46.2,33.98,38.65,6.25,27.88,4.98,4.13,4.23,782.75,35.02,38.55,194.9,8.3,20.59,7.1,37.98,93.59,2.62,1228.78,42.23,8.29,8.0,23.65,1.95,27.84,30.85,25.87,21.95,6.21,46.97,47.38,13.07,8.13,21.5,22.21,3.08,41.93,3.2,26.0,7.05,6.89,25.9,8.7,11.28,3.7,6.0,26.6,2.42,4.6,3.33,20.33,20.28,21.58,61.0,58.99,23.0,23.55,211.2,9.0,254.68,49.8,130.59,15.19,13.85,180.26,39.9,48.0,225.94,60.57,194.1,28.7,31.4,30.55,15.9,19.99,17.9,4.3,34.89,33.22,33.39,61.2,8.77,16.3,16.4,204.89,3.4,8.08,7.5,4.68,7.04,242.5,61.19,124.3,15.7,191.41,7.68,413.31,0.99,11.9,4.39,9.47,33.35,19.4,12.0,24.29,29.85,28.19,31.2,18.4,21.67,14.0,16.0,8.1,7.36,37.33,32.0,19.0,74.54,23.55,4.3,6.0,65.96,25.01,250.01,26.35,20.45,4.59,67.6,6.01,4.78,19.69,4.6,8.39,16.88,12.35,14.8,122.13,29.08,7.38,6.93,161.71,160.66,25.08,4.62,98.58,8.2,65.75,6.25,163.7,162.73,1.6,31.29,1.51,8.99,6.82,29.3,330.41,79.16,30.29,439.98,5.91,1.5,0.71,41.55,83.44,180.91,13.39,12.11,30.05,35.44,9.8,10.5,11.58,3.3,1.9,489.07,22.8,7.0,14.79,166.1,4.48,2.87,15.88,8.94,15.0,19.7,37.68,24.65,16.56,218.48,33.08,0.82,27.39,1007.54,18.27,7.9,6.32,42.0,117.33,54.0,169.78,43.6,76.18,167.99,7.08,159.31,5.44,180.42,4.26,181.61,27.0,2.29,56.09,8.6,25.09,287.78,5.48,12.39,155.14,727.28,383.61,14.81,24.36,23.8,45.0,1016.08,283.11,13.61,34.97,1.5,17.45,18.97,80.99,37.58,417.78,25.41,22.55,164.93,4.0,347.73,2.25,8.4,1.4,310.0,220.0,3.25,4.07,2.25,1.45,98.0,51.7,5.17,3.1,9.35,12.89,57.0,16.71,2.99,3.0,6.79,9.14,2.7,1.37,5.4,6.94,29.75,13.11,7.43,7.1,21.61,8.4,159.09,5.31,22.41,20.85,42.76,16.75,10.56,60.4,31.96,244.75,31.59,159.63,21.9,15.55,7.71,7.38,6.99,41.9,42.92,17.66,26.46,26.5,4.18,28.58,37.95,8.47,7.6,23.75,1.45,2.5,30.0,22.79,31.26,12.35,362.67,27.52,2.05,2.03,10.05,11.85,35.68,27.08,1.77,4.15,67.5,69.3,2.31,20.33,1.62,2.75,53.2,37.5,37.52,36.87,131.82,92.57,11.41,9.21,9.0,70.92,50.01,213.48,509.86,41.59,46.24,17.9,144.32,7.2,4.4,88.21,17.62,4.21,7.01,5.07,40.0,65.94,76.92,1.58,1.5,2.84,0.86,9.36,1.7,5.52,5.21,1.83,2.15,2.95,1.25,1.28,3.66,1.13,2.2,2.24,1.54,1.7,8.29,0.47,0.03,0.81,0.02,17.3,157.8,1191.0,1336.21,99.0,2060.0,139.99,139.7,54.97,86.03,103.03,108.95,74.5,121.5,89.6,103.51,13.95,1.73,72.99,78.96,82.0,101.5,4.07,2231.0,1009.36,479.0,152.01,285.0,43.5,168.0,207.0,2270.82,1992.0,106.95,160.0,69.4,427.0,198.0,2.75,84.99,2.75,1240.0,87.49,325.0,124.49,195.0,134.9,98.99,302.0,91.9,237.99,114.0,173.0,139.98,149.0,102.5,195.0,154.0,105.0,109.4,70.04,102.2,105.49,109.6,109.0,9.79,146.22,107.73,1874.0,1065.89,91.99,92.83,10.24,222.5,31.02,149.0,125.0,93.9,102.95,20.2,99.99,77.31,100.42,3004.0,356.0,73.9,217.99,270.0,42.0,89.0,101.46,108.5,52.99,71.73,90.0,1150.0,84.64,128.5,11.19,106.01,921.0,75.24,81.0,124.0,122.4,123.98,175.0,76.21,106.99,108.0,89.01,118.49,69.2,94.96,112.5,100.29,107.79,17.89,69.0,84.6,87.92,71.63,48.0,93.65,98.0,0.18,0.22,0.85,0.27,0.29,31.32,102.69,31.3,0.53,151.09,87.4,103.5,89.9,103.0,1.0,0.73,0.4,0.4,0.5,6.06,0.95,9.41]
now = datetime.datetime.now()
def random_number():
    return random.choice([1, -1,0])*0.01

def save_price(prices,time):
    ts = []
    for bond, price_value in prices:
        ts.append(Point("price").tag("bond", bond).field("value", price_value).time(time))
    write_api.write(bucket=bucket,org=org,record=ts)
    print("deu bom")
stock_order=[ "AALR3",
  "AAPL34",
  "ABBV34",
  "ABCB4",
  "ABEV3",
  "ADHM3",
  "AFLT3",
  "AGRO3",
  "ALPA3",
  "ALPA4",
  "ALSC3",
  "ALUP3",
  "ALUP4",
  "ALUP11",
  "AMAR3",
  "AMGN34",
  "AMZO34",
  "ANIM3",
  "APER3",
  "ARZZ3",
  "ATOM3",
  "ATTB34",
  "AZEV4",
  "AZUL4",
  "B3SA3",
  "BAHI3",
  "BAUH4",
  "BAZA3",
  "BBAS3",
  "BBDC3",
  "BBDC4",
  "BBRK3",
  "BBSE3",
  "BEEF3",
  "BEES3",
  "BEES4",
  "BERK34",
  "BGIP4",
  "BIDI4",
  "BIIB34",
  "BIOM3",
  "BKBR3",
  "BMEB4",
  "BNBR3",
  "BOAC34",
  "BOBR4",
  "BOEI34",
  "BOXP34",
  "BPAC3",
  "BPAC5",
  "BPAC11",
  "BPAN4",
  "BRAP3",
  "BRAP4",
  "BRDT3",
  "BRFS3",
  "BRIV4",
  "BRKM3",
  "BRKM5",
  "BRML3",
  "BRPR3",
  "BRSR3",
  "BRSR6",
  "BSEV3",
  "BTOW3",
  "BTTL3",
  "CAMB4",
  "CAML3",
  "CARD3",
  "CBEE3",
  "CCPR3",
  "CCRO3",
  "CCXC3",
  "CEDO4",
  "CEEB3",
  "CELP3",
  "CELP5",
  "CELP7",
  "CESP3",
  "CESP5",
  "CESP6",
  "CGAS3",
  "CGAS5",
  "CGRA3",
  "CGRA4",
  "CHVX34",
  "CIEL3",
  "CLGN34",
  "CLSC4",
  "CMCS34",
  "CMIG3",
  "CMIG4",
  "COCA34",
  "COCE3",
  "COCE5",
  "COLG34",
  "COPH34",
  "COWC34",
  "CPFE3",
  "CPLE3",
  "CPLE6",
  "CPRE3",
  "CRDE3",
  "CRFB3",
  "CRIV3",
  "CRPG5",
  "CRPG6",
  "CSAN3",
  "CSMG3",
  "CSNA3",
  "CSRN3",
  "CSRN5",
  "CTGP34",
  "CTKA4",
  "CTNM3",
  "CTNM4",
  "CTSA3",
  "CTSA4",
  "CTSH34",
  "CVCB3",
  "CVSH34",
  "CYRE3",
  "DEAI34",
  "DIRR3",
  "DISB34",
  "DMMO3",
  "DTEX3",
  "EALT4",
  "ECOR3",
  "EGIE3",
  "EKTR4",
  "ELEK4",
  "ELET3",
  "ELET5",
  "ELET6",
  "ELPL3",
  "EMAE4",
  "EMBR3",
  "ENBR3",
  "ENEV3",
  "ENGI3",
  "ENGI4",
  "ENGI11",
  "ENMA3B",
  "ENMT3",
  "EQTL3",
  "ESTC3",
  "EUCA4",
  "EVEN3",
  "EXXO34",
  "EZTC3",
  "FBOK34",
  "FESA3",
  "FESA4",
  "FHER3",
  "FIBR3",
  "FJTA3",
  "FJTA4",
  "FLRY3",
  "FRAS3",
  "GBIO33",
  "GFSA3",
  "GGBR3",
  "GGBR4",
  "GILD34",
  "GNDI3",
  "GOAU3",
  "GOAU4",
  "GOGL34",
  "GOGL35",
  "GOLL4",
  "GPIV33",
  "GPSI34",
  "GRND3",
  "GSGI34",
  "GSHP3",
  "GUAR3",
  "GUAR4",
  "HAGA4",
  "HAPV3",
  "HBOR3",
  "HBTS5",
  "HETA4",
  "HGTX3",
  "HOME34",
  "HPQB34",
  "HYPE3",
  "IBMB34",
  "IDNT3",
  "IDVL3",
  "IDVL4",
  "IGTA3",
  "IRBR3",
  "ITLC34",
  "ITSA3",
  "ITSA4",
  "ITUB3",
  "ITUB4",
  "JBDU3",
  "JBDU4",
  "JBSS3",
  "JFEN3",
  "JHSF3",
  "JNJB34",
  "JPSA3",
  "JSLG3",
  "KEPL3",
  "KHCB34",
  "KLBN3",
  "KLBN4",
  "KLBN11",
  "KROT3",
  "LAME3",
  "LAME4",
  "LCAM3",
  "LEVE3",
  "LIGT3",
  "LILY34",
  "LINX3",
  "LIQO3",
  "LLIS3",
  "LMTB34",
  "LOGG3",
  "LOGN3",
  "LPSB3",
  "LREN3",
  "MACY34",
  "MAGG3",
  "MCDC34",
  "MDIA3",
  "MDLZ34",
  "MDTC34",
  "MEAL3",
  "METB34",
  "MGEL4",
  "MGLU3",
  "MILS3",
  "MMMC34",
  "MNDL3",
  "MNPR3",
  "MOSC34",
  "MOVI3",
  "MPLU3",
  "MRCK34",
  "MRFG3",
  "MRVE3",
  "MSBR34",
  "MSCD34",
  "MSFT34",
  "MTSA4",
  "MULT3",
  "MYPK3",
  "NATU3",
  "NFLX34",
  "NIKE34",
  "ODPV3",
  "OFSA3",
  "OGXP3",
  "OMGE3",
  "PARD3",
  "PCAR4",
  "PEAB3",
  "PEPB34",
  "PETR3",
  "PETR4",
  "PFIZ34",
  "PFRM3",
  "PGCO34",
  "PINE4",
  "PLAS3",
  "PMAM3",
  "PNVL3",
  "PNVL4",
  "POMO3",
  "POMO4",
  "POSI3",
  "PPLA11",
  "PRIO3",
  "PSSA3",
  "PTBL3",
  "PTNT4",
  "QGEP3",
  "QUAL3",
  "RADL3",
  "RAIL3",
  "RANI3",
  "RANI4",
  "RAPT3",
  "RAPT4",
  "RCSL3",
  "RCSL4",
  "RDNI3",
  "REDE3",
  "RENT3",
  "RLOG3",
  "RNEW3",
  "RNEW4",
  "RNEW11",
  "ROMI3",
  "ROST34",
  "RSID3",
  "SANB3",
  "SANB4",
  "SANB11",
  "SAPR3",
  "SAPR4",
  "SAPR11",
  "SBSP3",
  "SBUB34",
  "SCAR3",
  "SCHW34",
  "SEDU3",
  "SEER3",
  "SGPS3",
  "SHOW3",
  "SHUL4",
  "SLCE3",
  "SMLS3",
  "SMTO3",
  "SNSL3",
  "SSBR3",
  "STBP3",
  "SULA11",
  "SUZB3",
  "TAEE3",
  "TAEE4",
  "TAEE11",
  "TCSA3",
  "TECN3",
  "TELB3",
  "TELB4",
  "TEND3",
  "TESA3",
  "TEXA34",
  "TGMA3",
  "TIET3",
  "TIET4",
  "TIET11",
  "TIMP3",
  "TKNO4",
  "TOTS3",
  "TOYB4",
  "TRIS3",
  "TRPL3",
  "TRPL4",
  "TRPN3",
  "TUPY3",
  "TXRX4",
  "UCAS3",
  "UGPA3",
  "UNIP3",
  "UNIP5",
  "UNIP6",
  "UPAC34",
  "UPSS34",
  "USIM3",
  "USIM5",
  "USIM6",
  "USSX34",
  "VALE3",
  "VERZ34",
  "VISA34",
  "VIVT3",
  "VIVT4",
  "VLID3",
  "VLOE34",
  "VULC3",
  "VVAR3",
  "WALM34",
  "WEGE3",
  "WHRL3",
  "WIZS3",
  "WLMM4",
  "WSON33",
  "WUNI34",
  "XRXB34",
  "TPIS3",
  "BPHA3",
  "ETER3",
  "FRTA3",
  "GPCP3",
  "IGBR3",
  "INEP3",
  "INEP4",
  "LUPA3",
  "MMXM3",
  "MWET4",
  "OIBR3",
  "OIBR4",
  "OSXB3",
  "PDGR3",
  "SLED3",
  "SLED4",
  "TCNO3",
  "TCNO4",
  "TEKA4",
  "VIVR3",
  "PLAS1",
  "POMO2",
  "VIVR1",
  "ABCP11",
  "AEFI11",
  "AGCX11",
  "ALMI11",
  "ALZR11",
  "BBFI11B",
  "BBPO11",
  "BBRC11",
  "BBVJ11",
  "BCFF11",
  "BCIA11",
  "BCRI11",
  "BMLC11B",
  "BNFS11",
  "BPFF11",
  "BRCR11",
  "BZLI11",
  "CARE11",
  "CBOP11",
  "CEOC11",
  "CNES11",
  "CPTS11B",
  "CTXT11",
  "CXCE11B",
  "CXRI11",
  "CXTL11",
  "DRIT11B",
  "EDFO11B",
  "EDGA11",
  "EURO11",
  "FAED11",
  "FAMB11B",
  "FCFL11",
  "FEXC11",
  "FFCI11",
  "FIGS11",
  "FIIB11",
  "FIIP11B",
  "FIVN11",
  "FIXX11",
  "FLMA11",
  "FLRP11",
  "FMOF11",
  "FPAB11",
  "FVBI11",
  "FVPQ11",
  "GGRC11",
  "GRLV11",
  "HCRI11",
  "HFOF11",
  "HGBS11",
  "HGCR11",
  "HGJH11",
  "HGLG11",
  "HGRE11",
  "HGRU11",
  "HMOC11",
  "HTMX11",
  "HUSC11",
  "IRDM11",
  "JRDM11",
  "JSRE11",
  "KNCR11",
  "KNHY11",
  "KNIP11",
  "KNRE11",
  "KNRI11",
  "MALL11",
  "MAXR11",
  "MBRF11",
  "MFII11",
  "MGFF11",
  "MXRF11",
  "NSLU11",
  "NVHO11",
  "ONEF11",
  "ORPD11",
  "OUCY11",
  "OUJP11",
  "PABY11",
  "PDDA11B",
  "PLRI11",
  "PORD11",
  "PQDP11",
  "PRSV11",
  "RBBV11",
  "RBCB11",
  "RBDS11",
  "RBGS11",
  "RBRD11",
  "RBRF11",
  "RBRR11",
  "RBVO11",
  "RDES11",
  "RDPD11",
  "REIT11",
  "RNGO11",
  "SAAG11",
  "SCPF11",
  "SDIL11",
  "SHPH11",
  "SPTW11",
  "TBOF11",
  "TFOF11",
  "TGAR11",
  "THRA11",
  "TRNT11",
  "TRXL11",
  "UBSR11",
  "VISC11",
  "VLOL11",
  "VRTA11",
  "WPLZ11",
  "XPCM11",
  "XPIN11",
  "XPLG11",
  "XPML11",
  "XTED11",
  "BBSD11",
  "BOVA11",
  "BOVV11",
  "BRAX11",
  "DIVO11",
  "ECOO11",
  "FIND11",
  "FNAM11",
  "FNOR11",
  "FPOR11",
  "FSRF11",
  "FSTU11",
  "ISUS11",
  "IVVB11",
  "MATB11",
  "MMXM11",
  "PIBB11",
  "SMAL11",
  "SPXI11",
  "XBOV11",
  "XPOM11",
  "BEEF11",
  "FJTA11",
  "FJTA13",
  "FJTA15",
  "FJTA17",
  "LOGN12",
  "MYPK11",
  "MYPK12"]

for sec in range(1,28800):
    print(sec)
    prices = [(stock_order[i],v+random_number())for i,v in enumerate(start_prices)]
    insert_time = now + datetime.timedelta(0,1)
    print(now.timestamp(),insert_time.timestamp())
    save_price(prices,insert_time)
    now = insert_time
    # break
